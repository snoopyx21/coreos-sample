variant: fcos
version: 1.5.0
storage:
  files:
    - path: /etc/hostname
      mode: 0644
      contents:
        inline: ganymede
    - path: /etc/profile.d/systemd-pager.sh
      mode: 0644
      contents:
        inline: |
          # Tell systemd to not use a pager when printing information
          export SYSTEMD_PAGER=cat
    - path: /etc/NetworkManager/system-connections/ens33.nmconnection
      mode: 0600
      overwrite: true
      contents:
        inline: |
          [connection]
          type=ethernet
          interface-name=ens33
          id=ens33

          [ipv4]
          method=manual
          addresses=10.1.1.10/24
          gateway=10.1.1.1
          dns=1.1.1.1
          dns-search=ganymede.blog
          dns-options=rotate,timeout:1
systemd:
  units:
    - name: tomcat.service
      enabled: true
      contents:
        local: ./quadlets/whoami.container
    - name: serial-getty@ttyS0.service
      dropins:
      - name: autologin-core.conf
        contents: |
          [Service]
          # Override Execstart in main unit
          ExecStart=
          # Add new Execstart with `-` prefix to ignore failure`
          ExecStart=-/usr/sbin/agetty --autologin core --noclear %I $TERM
          
passwd:
  users:
    - name: core
      groups:
        - wheel
        - sudo
      shell: /bin/bash
      password_hash: $2y$10$OEWTHFX1W0YULmXfxco/tO4oC6mTeV8xNC6fNzJEhJnAy23jztbsG
